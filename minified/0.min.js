let t,e,n,o,r,s,i,c,l,f,u,a,p,h,C,T,k,I,E,_,S,g,O,d,W,R,M,L,A,N,P,w,F,b,H,v,x,V,D,G,K,Y,X,j,U,m,y,B=1;const $=700,q=400,Q=$/q,z=4,J=-$/2,Z=$/2,tt=-q/2,et=q/2,nt={1:[J,tt],2:[Z,tt],3:[J,et],4:[Z,et]};let ot,rt,st=!1,it=!1;function setup(){const e=window.innerWidth/window.innerHeight;Q<e?(ot=createCanvas(window.innerHeight*Q,window.innerHeight),t=window.innerHeight/q):Q>e?(ot=createCanvas(window.innerWidth,window.innerWidth/Q),t=window.innerWidth/$):(ot=createCanvas(window.innerWidth,window.innerHeight),t=window.innerWidth/$);const n=(rt=createGraphics($,q)).pixelDensity()||2;rt.pixelDensity(n*z),noLoop(),colorMode(HSB,360,100,100,100),ct()}function ct(){const t=cn(0);t<.5?u="1":t<.75?u="5":t<7/8?u="10":t<.9375?u="20":t<31/32?u="50":t<63/64?u="100":t<127/128&&(u="2"),I=ln(.2);const l=cn(1);if(COLOR_SCHEME=l<.65?"FIAT":l<.9?"CRYPTO":"BULLION",C="BULLION"===COLOR_SCHEME,IS_CRYPTO="CRYPTO"===COLOR_SCHEME,"FIAT"===COLOR_SCHEME)f=int(sn(0,360)),e=color(f,26,25),o=color(an(f-72),6,91),r=color(an(max(f-72,0)),6,91),n=color(f,16,55),c=color(an(f-145),80,64),LIGHT_ACCENT_C=color(an(f-145),55,64,30),s=color(max(f-10,0),80,54),i=s,w=ln(.02);else if(IS_CRYPTO){const t=(f=int(sn(0,360)))<275&&f>210;o=color(an(f-133),96,t?0:15),e=color(f,t?80:100,t?95:90),n=color(f,69,75),c=color(an(f-254),100,100),LIGHT_ACCENT_C=c,i=s=c,r=o}else f=int(sn(0,360)),e=color(f,26,25),l<.96875?(o=color(203,5,48),s=color(167,5,95),e=color(40,26,20),n=color(203,10,35),i=n,m=!0):(o=color(40,60,67),s=color(60,30,100),e=color(35,45,30),n=color(35,45,35),i=color(203,10,25)),c=e,LIGHT_ACCENT_C=n,r=o,k=!0;y=cn(2)<.8125?"MAIN":cn(2)<.95?"STRIP":"GRID",T="MAIN"===y,Y=ln(.01)&&T&&!P,MAIN_CENTER_PIECE=Ct(cn(3)),S=T&&cn(4)<.75,g=T&&ln(S?.9:.6);const K=cn(5);K<.0625?(a="DECO",h=!0):K<.6?a="NUMISMATIC":K<.8?(a="VINTAGE",p=!0):a=K<.86?"ECHO":K<.96?"DIGITAL":K<.9825?"LINE":"DENOMINATION",F=ln(.03125),W=[0,1,3].includes(MAIN_CENTER_PIECE)&&"WM2"!==E&&cn(7)<.25,R=W&&ln(.4),M=W&&!R&&ln(.2),L=W&&cn(7)<.0625,A=L&&ln(.4),N=L&&!A&&ln(.2);const $=ln(.5)||C,q=m?s:r,Q=!k||h||p||C?e:i;ROSETTE_FILL_C=p||$?q:Q,ROSETTE_STROKE_C=p||$?Q:q,k=!p&&ln(.125);const z=cn(6);!T||S||z<.1875?(E="STANDARD",_=ne()):E=z<.5?"WM2":z<.8125?"WM1":p||h?ln(.5)?"WM1":"WM2":z<.9375||IS_CRYPTO?"FULL":"EMPTY",P=!g&&8!==_&&!R&&!A,serialSeed=sn(),j=serialSeed<.005?0:serialSeed<.01?1:serialSeed<.015?2:serialSeed<.02?3:serialSeed<.025?4:serialSeed<.03?5:serialSeed<.035?6:"",d=cn(8)<.02,b=ln(.02),Y=Y&&!P,v=ln(.015),D=ln(.015),H=ln(.015),V=ln(.01),G=ln(.005),MISPRINT_HEAVY_INK=ln(.005),x=ln(.005),IS_MISPRINT=F||b||Y||v||D||H||V||G||MISPRINT_HEAVY_INK||x,U=!j&&!d&&ln(.1),MISPRINT_HEAVY_INK&&(B=8),X=b||H||F,O=g||X?Tt():[]}function lt(){push();const t=fn(),n=sn(0,100);C||strokeWeight(2);for(let r=-n;r<=$+n;r++){const i=1===t?r-$/2:$/2-r;stroke(lerpColor(o,w||C||k?s:e,w||C||IS_CRYPTO&&k?r/$:r/(5*$))),line(i+n,-q/2,i,q/2)}pop(),"FIAT"===COLOR_SCHEME&&re(),IS_CRYPTO&&"STANDARD"!==E&&se(),IS_CRYPTO||oe()}function draw(){translate(width/2,height/2),scale(t),noFill(),stroke(e),lt(),v&&ut(),D&&ft(),strokeWeight(B),T||G?ht():"STRIP"===y?vt():Ht(),V&&at(),x&&pt();const n=(u||0)*(U?-1:1)*(IS_MISPRINT?0:1)*(IS_CRYPTO?ln(.5)?sn(0,150):sn(0,.1):1)*(m?50:1)*(C&&!m?100:1)*(d?3:1)*(j?5:1)*(p||h?1.5:1);try{console.log("Estimated Market Value: "+n)}catch(t){}}function keyPressed(){83===keyCode&&saveCanvas(ot,"FIM-"+Date.now(),"jpg")}function ft(){translate(-1)}function ut(){translate(sn($/4,q/4)*fn(),sn($/4,q/4)*fn()),rotate(sn(HALF_PI,-HALF_PI))}function at(){push(),fill(o),strokeWeight(0),beginShape(),vertex(sn(-$/2,$/2),-q/2),vertex(sn(-$/2,$/2),q/2),vertex(sn(-$/2,$/2),-q/2),endShape(),pop()}function pt(){strokeWeight(0);for(let t=0;t<=$;t++)for(let e=0;e<=q;e++)fill(0,0,100,sn(0,60)),rect(t-$/2,e-q/2,2)}function ht(){let t=[],e=!1;if("STANDARD"===E)ee();else if("WM2"===E)Te(t=dt(O));else if("WM1"===E){const e=Ot(O);t=[e];const o=175*_t(e),r=80*St(e,4===O.length),s=k?LIGHT_ACCENT_C:n;ln(.8)?Ee(o,r,s):Oe(o+15,r,245,s)}else"FULL"===E&&(ke(),e=!0);switch(S&&Ve(),kt(O),MAIN_CENTER_PIECE){case 0:break;case 1:Pt();break;case 2:wt();break;case 3:Mt();break;case 4:Ft()}const o=fn();W&&(R?At(o):M?xe(205*o):Lt(o)),L&&(A?At(-1*o):N?xe(-205*o):Lt(-1*o)),G&&Kt(),Wt(t.length||4===O.length?t:O,e)}function Ct(t){if(T)return Y?0:t<.6875?1:t<.8125?2:t<.9375?3:4}function Tt(){const t=sn();return t<.25?[1,2,3,4]:t<.5?[1,4]:t<.75?[2,3]:t<.825?[1,2]:t<.9375?[3,4]:[int(sn(1,5))]}function kt(t=[]){push(),strokeWeight(.6*B);const e=ln(.125),n=4===t.length&&ln(.5)?[un([1,3]),un([2,4])]:[],o=zt(Nt());t.forEach(t=>{const[r,s]=nt[t],i=r+(t%2==1?52:-52),c=s+(t<3?52:-52),l=e||n.includes(t)?37.5:0;Yt(i,c,50,0,{...o,holeR:l}),nn(i,c,.3,ROSETTE_FILL_C,ROSETTE_STROKE_C)}),pop()}const It=t=>[1,2,3,4].filter(e=>!t.includes(e)),Et=t=>({1:4,2:3,3:2,4:1})[t],_t=t=>t%2!=0?-1:1,St=(t,e)=>e?0:t<3?-1:1,gt=(t,e)=>t.every((t,n)=>t===e[n])&&t.length===e.length,Ot=t=>4!==t.length&&t.length?1===t.length?Et(t[0]):un(It(t)):un([1,2,3,4]);function dt(t){return 4!==t.length&&t.length?gt(t,[1,4])||gt(t,[2,3])?un([[1,4],[2,3]]):1===t.length?It([t[0],Et(t[0])]):[Et(t[0]),Et(t[1])]:un([[1,4],[2,3],[1,2],[3,4]])}function Wt(t=[],e=!1){const n=115+(S?0:30),o=1===t.length?Et(t[0]):un(It(t)),r=un(It([o,...t])),s=(S?150:120)*_t(o),i=150*_t(r);Ae(s>0?s+85:s,n*St(o),10,e),Fe(i<0?i-65:i,n*St(r))}function Rt(t,e=!1){if(push(),e||ln(.25))rotate(.75*TWO_PI*t),Fe(-$/6-25,-$/3-80),Ae($/6+35,-$/3-80,10);else{const e=t>0;Fe((5*$/12+(e?30:-35))*-t,q/3+15),Ae(e?70:-5,q/3+20,10)}pop()}function Mt(){const t=p?{c1:-1,c2:185}:{holeR:135,c1:1,c2:-1,r1:15,r2:14,...Nt()};Yt(0,0,p?170:155,0,t);const e=sn();P||e<.1?on(0,0,2.3):e<.8?Ee(0,0,ROSETTE_STROKE_C,p?.5:.7):e<.92?Oe(0,0,200):e<.98&&Ie(0,0,250)}function Lt(t){const e=int(sn(3,11))*fn();yt(210*t,20,40,0,Zt({strokeC:c,strokeW:1,rDiff:2,ignoreShrink:!0,c1:e,c2:(e+5)*fn()}))}function At(t){nn(205*t,20,.65,LIGHT_ACCENT_C,LIGHT_ACCENT_C)}const Nt=()=>p?{}:{strokeC:ROSETTE_STROKE_C,innerC:k?ROSETTE_STROKE_C:n,outterC:ROSETTE_FILL_C};function Pt(){const t=!p&&ln(.5),e=ln(.25)?un([1,2]):0,n=Nt();Yt(0,0,150,0,n),t?Yt(0,0,70,0,{...n,holeR:60}):e&&(Yt(0,0,110,0,0,n),e>1&&Yt(0,0,70,0,0,n)),(P||t||e<2||ln(.9375))&&on(0,0,1)}function wt(){const t=un([1,2,3]),e=Nt();if(3===t){const t=zt(e);Yt(150,0,80,0,t),Yt(-150,0,80,0,t)}const n=zt(e);if(Yt(110,0,100,0,n),Yt(-110,0,100,0,n),t>1){const t=zt(e);Yt(60,0,130,0,t),Yt(-60,0,130,0,t)}Yt(0,0,150,0,zt(e)),Yt(0,0,70,0,{...zt(e),holeR:u?60:0}),on(0,0,.65)}function Ft(){const t=sn(),e=Nt();if(t<.125){const t=zt(e);Yt(25,-120,25,0,t),Yt(25,120,25,0,t),Yt(-25,-120,25,0,t),Yt(-25,120,25,0,t)}if(t<.25){const t=zt(e);Yt(50,-90,45,0,t),Yt(50,90,45,0,t),Yt(-50,-90,45,0,t),Yt(-50,90,45,0,t)}if(t<.5){const t=zt(e);Yt(90,-50,70,0,t),Yt(90,50,70,0,t),Yt(-90,-50,70,0,t),Yt(-90,50,70,0,t)}const n=zt(e);Yt(130,0,90,0,n),Yt(-130,0,90,0,n),on(0,0,.65)}function bt(){const t=Nt();Yt(0,0,120,0,zt(t)),Yt(0,0,90,0,zt(t)),Yt(0,0,60,0,zt(t)),tn(u,-142,2,.65,e),tn(u,142,2,.65,e),tn(u,-140,0,.65,e,o),tn(u,140,0,.65,e,o)}function Ht(){ee(),Vt(1,!0),Vt(0,!0),Vt(-1,!0),Rt(fn(),!0)}function vt(){ee();const t=fn();ln(.5)&&xt(t),Vt(t);const e=sn(),n=$/-6*t;if(e<.65||X){const e=Nt();Yt($/-6*t,0,180,0,e),(p||ln(.3125))&&(Yt($/-6*t,0,135,0,e),Yt($/-6*t,0,90,0,e),p&&Yt($/-6*t,0,70)),ln(.1)&&Oe(n,0,245)}else e<.9?(Ee(n,0),(ln(.1)||0===_)&&Oe(n,0,245)):e<.97?Oe(n,0,245):e<.99?on(n,0,3):Ie($/-6*t,0,300);ln(.5)&&Gt(-1*t,1),ln(.5)&&Gt(-1*t,-1),Rt(t)}function xt(t=-1){push(),k&&stroke(i),line($*t/6-1,20-q/2,$*t/6-1,q/2-20),line($*t/6+1,20-q/2,$*t/6+1,q/2-20),pop()}function Vt(t=-1,e=!1){if(ln(.5)&&!e)Dt(q/3*(ln(.5)?1:-1),t);else{const e=un([1,2,3]);Dt(-q/3,t,1!=e),Dt(0,t,2!=e),Dt(q/3,t,3!=e)}}function Dt(t,e,n=!1){const o=$/3*e;X&&!t&&!e||ln(.15)&&n?Yt(o,t,55,0,Nt()):on(o,t,1.1)}function Gt(t=1,e=1){push(),strokeCap(SQUARE);const n=$/2*t,o=-q/2*e;line(n-35*t,o+20*e,n-10*t,o+20*e),line(n-10*t,o+20*e,n-10*t,o+45*e),line(n-35*t,o+25*e,n-15*t,o+25*e),line(n-15*t,o+25*e,n-15*t,o+45*e),pop()}function Kt(){kn(25,()=>{let t=sn(25,200);const e=sn(J,Z),n=sn(tt,et);Yt(e,n,t,ln(.5)?0:sn(t/5,t),{skipBg:ln(.9)}),ln(.5)&&on(e,n,t/120)})}function Yt(t,e,n,o=0,r={}){p&&(n*=.75),h&&(r={...r,fillC:ROSETTE_FILL_C,strokeMod:6});const s=p?Jt(r):Zt(r);r.skipBg||(p?qt:mt)(t,e,n,o,{...s,strokeC:ROSETTE_FILL_C,fillC:ROSETTE_FILL_C,strokeMod:6}),Xt()(t,e,n,r.holeR||o,{...s,strokeC:ROSETTE_STROKE_C,innerC:!1})};