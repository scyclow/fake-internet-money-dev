let e,t,n,o,r,s,i,c,l,f,u,a,h,p,C,T,E,k,I,_,d,g,O,S,W,M,R,L,A,P,N,w,b,F,H,v,x,V,D,G,K,X,Y;let j=700,U=400,m=j/U,$=4,B=-j/2,y=j/2,q=-U/2,Q=U/2,z={1:[B,q],2:[y,q],3:[B,Q],4:[y,Q]};let J,Z,ee=!1,te=!1;function setup(){let n=window.innerWidth/window.innerHeight;m<n?(J=createCanvas(window.innerHeight*m,window.innerHeight),e=window.innerHeight/U):m>n?(J=createCanvas(window.innerWidth,window.innerWidth/m),e=window.innerWidth/j):(J=createCanvas(window.innerWidth,window.innerHeight),e=window.innerWidth/j),Z=createGraphics(j*$,U*$),noLoop(),colorMode(HSB,360,100,100,100),ne(),document.body.style.backgroundColor=t.toString()}function ne(){let e=Jt(0);e<.5?u="1":e<.75?u="5":e<7/8?u="10":e<.9375?u="20":e<31/32?u="50":e<63/64?u="100":e<127/128&&(u="2"),E=Zt(.2);let l=Jt(1);let D;if(COLOR_SCHEME=l<.65?"FIAT":l<.9?"CRYPTO":"BULLION",C="BULLION"===COLOR_SCHEME,IS_CRYPTO="CRYPTO"===COLOR_SCHEME,"FIAT"===COLOR_SCHEME)f=int(zt(0,360)),t=color(f,26,25),o=color(nn(f-72),6,91),r=color(nn(max(f-72,0)),6,91),n=color(f,16,55),c=color(nn(f-145),80,64),LIGHT_ACCENT_C=color(nn(f-145),55,64,30),s=color(max(f-10,0),80,54),i=s,P=Zt(.02);else if("CRYPTO"===COLOR_SCHEME){let e=(f=int(zt(0,360)))<275&&f>210;o=color(nn(f-133),96,e?0:15),t=color(f,e?80:99,e?95:90),n=color(f,69,75),c=color(nn(f-254),100,100),LIGHT_ACCENT_C=c,i=s=c,r=o}else f=int(zt(0,360)),t=color(f,26,25),l<.96875?(o=color(203,5,48),s=color(167,5,95),t=color(40,26,20),n=color(203,10,35),i=n,D=!0):(o=color(40,60,67),s=color(60,30,100),t=color(35,45,30),n=color(35,45,35),i=color(203,10,25)),c=t,LIGHT_ACCENT_C=n,r=o,T=!0;let j="MAIN"==(Y=Jt(2)<.8125?"MAIN":Jt(2)<.95?"STRIP":"GRID");MAIN_CENTER_PIECE=fe(Jt(3)),_=j&&Jt(4)<.75,d=j&&Zt(_?.9:.6);let U=Jt(5);U<.0625?(a="DECO",p=!0):U<.625?a="NUMISMATIC":U<.8125?(a="VINTAGE",h=!0):a=U<.875?"ECHO":U<.9375?"DIGITAL":"LINE",N=Zt(.0625);let m=Zt(.5)||C,$=D?s:r,B=!T||p||h||C?t:i;ROSETTE_FILL_C=h||m?$:B,ROSETTE_STROKE_C=h||m?B:$,T=!h&&Zt(.125);let y=Jt(6);!j||_||y<.1875?(k="STANDARD",I=Qe()):k=y<.5?"WM2":y<.8125?"WM1":h||p?Zt(.5)?"WM1":"WM2":y<.9375||IS_CRYPTO?"FULL":"EMPTY",O=[0,1,3].includes(MAIN_CENTER_PIECE)&&"WM2"!==k&&Jt(7)<.25,S=O&&Zt(.4),W=O&&!S&&Zt(.2),M=O&&Jt(7)<.0625,R=M&&Zt(.4),L=M&&!R&&Zt(.2),A=!d&&8!==I&&!S&&!R,serialSeed=zt(),K=serialSeed<.005?0:serialSeed<.01?1:serialSeed<.015?2:serialSeed<.02?3:serialSeed<.025?4:serialSeed<.03?5:serialSeed<.035?6:"",g=Jt(8)<.02,w=Zt(.02),F=Zt(.015),x=Zt(.015),b=Zt(.015),v=Zt(.01),V=Zt(.005),MISPRINT_HEAVY_INK=Zt(.005),H=Zt(.005),X=!K&&!g&&Zt(.1),G=w||b||N}function oe(){push();let e=en(),n=zt(0,100);C||strokeWeight(2);for(let r=-n;r<=j+n;r++){let i=1===e?r-j/2:j/2-r;stroke(lerpColor(o,P||C||T?s:t,P||C||IS_CRYPTO&&T?r/j:r/(5*j))),line(i+n,-U/2,i,U/2)}pop(),"FIAT"===COLOR_SCHEME&&Je(),"CRYPTO"!==COLOR_SCHEME&&ze()}function draw(){translate(width/2,height/2),scale(e),noFill(),stroke(t),oe(),F&&se(),x&&re(),MISPRINT_HEAVY_INK&&strokeWeight(8),"MAIN"===Y||V?le():"STRIP"===Y?Ne():Pe(),v&&ie(),H&&ce(),console.log("$"+(u||0))}function keyPressed(){83===keyCode&&saveCanvas(J,"FIM-"+Date.now(),"jpg")}function re(){translate(-1)}function se(){translate(zt(j/4,U/4)*en(),zt(j/4,U/4)*en()),rotate(zt(HALF_PI,-HALF_PI))}function ie(){push(),fill(o),strokeWeight(0),beginShape(),vertex(zt(-j/2,j/2),-U/2),vertex(zt(-j/2,j/2),U/2),vertex(zt(-j/2,j/2),-U/2),endShape(),pop()}function ce(){strokeWeight(0);for(let e=0;e<=j;e++)for(let t=0;t<=U;t++)fill(0,0,100,zt(0,60)),rect(e-j/2,t-U/2,2)}function le(){let e=d||G?ue():[];let t=[],o=!1;if("STANDARD"===k)qe();else if("WM2"===k)lt(t=Ie(e));else if("WM1"===k){let o=ke(e);t=[o];let r=175*Ce(o),s=80*Te(o,4===e.length),i=T?LIGHT_ACCENT_C:n;Zt(.8)?at(r,s,i):Tt(r+15,s,245,i)}else"FULL"===k&&(ft(),o=!0);switch(_&&Pt(),ae(e),MAIN_CENTER_PIECE){case 0:break;case 1:Me();break;case 2:Re();break;case 3:ge();break;case 4:Le()}let r=en();O&&(S?Se(r):W?At(205*r):Oe(r)),M&&(R?Se(-1*r):L?At(-205*r):Oe(-1*r)),V&&ve(),_e(t.length||4===e.length?t:e,o)}function fe(e){if("MAIN"===Y)return e<.02?0:e<.6875?1:e<.8125?2:e<.9375?3:4}function ue(){let e=zt();return e<.25?[1,2,3,4]:e<.5?[1,4]:e<.75?[2,3]:e<.825?[1,2]:e<.9375?[3,4]:[int(zt(1,5))]}function ae(e=[]){let t=Zt(.125),n=4===e.length&&Zt(.5)?[tn([1,3]),tn([2,4])]:[],o=me(We());e.forEach(e=>{let[r,s]=z[e],i=r+(e%2==1?57:-57),c=s+(e<3?57:-57),l=t||n.includes(e)?41.25:0;xe(i,c,55,0,{...o,holeR:l}),yt(i,c,.35,ROSETTE_FILL_C,ROSETTE_STROKE_C)})}let he=e=>[1,2,3,4].filter(t=>!e.includes(t)),pe=e=>({1:4,2:3,3:2,4:1})[e],Ce=e=>e%2!=0?-1:1,Te=(e,t)=>t?0:e<3?-1:1,Ee=(e,t)=>e.every((e,n)=>e===t[n])&&e.length===t.length,ke=e=>4!==e.length&&e.length?1===e.length?pe(e[0]):tn(he(e)):tn([1,2,3,4]);function Ie(e){return 4!==e.length&&e.length?Ee(e,[1,4])||Ee(e,[2,3])?tn([[1,4],[2,3]]):1===e.length?he([e[0],pe(e[0])]):[pe(e[0]),pe(e[1])]:tn([[1,4],[2,3],[1,2],[3,4]])}function _e(e=[],t=!1){let n=115+(_?0:30),o=1===e.length?pe(e[0]):tn(he(e)),r=tn(he([o,...e])),s=(_?150:120)*Ce(o),i=150*Ce(r);gt(s>0?s+85:s,n*Te(o),10,t),Mt(i<0?i-65:i,n*Te(r))}function de(e,t=!1){if(push(),t||Zt(.25))rotate(.75*TWO_PI*e),Mt(-j/6-25,-j/3-80),gt(j/6+35,-j/3-80,10);else{let t=e>0;Mt((5*j/12+(t?30:-35))*-e,U/3+15),gt(t?70:-5,U/3+20,10)}pop()}function ge(){let e=h?{c1:-1,c2:185}:{holeR:135,c1:1,c2:-1,r1:15,r2:14,...We()};xe(0,0,h?170:155,0,e);let t=zt();A||t<.1?qt(0,0,2.3):t<.8?at(0,0,ROSETTE_STROKE_C,h?.5:.7):t<.92?Tt(0,0,200):t<.98&&ut(0,0,250)}function Oe(e){let t=int(zt(3,11))*en();Xe(210*e,20,40,0,Be({strokeC:c,strokeW:1,rDiff:2,ignoreShrink:!0,c1:t,c2:(t+5)*en()}))}function Se(e){yt(205*e,20,.65,LIGHT_ACCENT_C,LIGHT_ACCENT_C)}let We=()=>h?{}:{strokeC:ROSETTE_STROKE_C,innerC:T?ROSETTE_STROKE_C:n,outterC:ROSETTE_FILL_C};function Me(){let e=!h&&Zt(.5),t=Zt(.25)?tn([1,2]):0,n=We();xe(0,0,150,0,n),e?xe(0,0,70,0,{...n,holeR:60}):t&&(xe(0,0,110,0,0,n),t>1&&xe(0,0,70,0,0,n)),(A||e||t<2||Zt(.9375))&&qt(0,0,1)}function Re(){let e=tn([1,2,3]),t=We();if(3===e){let e=me(t);xe(150,0,80,0,e),xe(-150,0,80,0,e)}let n=me(t);if(xe(110,0,100,0,n),xe(-110,0,100,0,n),e>1){let e=me(t);xe(60,0,130,0,e),xe(-60,0,130,0,e)}xe(0,0,150,0,me(t)),xe(0,0,70,0,{...me(t),holeR:u?60:0}),qt(0,0,.65)}function Le(){let e=zt(),t=We();if(e<.125){let e=me(t);xe(25,-120,25,0,e),xe(25,120,25,0,e),xe(-25,-120,25,0,e),xe(-25,120,25,0,e)}if(e<.25){let e=me(t);xe(50,-90,45,0,e),xe(50,90,45,0,e),xe(-50,-90,45,0,e),xe(-50,90,45,0,e)}if(e<.5){let e=me(t);xe(90,-50,70,0,e),xe(90,50,70,0,e),xe(-90,-50,70,0,e),xe(-90,50,70,0,e)}let n=me(t);xe(130,0,90,0,n),xe(-130,0,90,0,n),qt(0,0,.65)}function Ae(){let e=We();xe(0,0,120,0,me(e)),xe(0,0,90,0,me(e)),xe(0,0,60,0,me(e)),$t(u,-142,2,.65,t),$t(u,142,2,.65,t),$t(u,-140,0,.65,t,o),$t(u,140,0,.65,t,o)}function Pe(){qe(),be(1,!0),be(0,!0),be(-1,!0),de(en(),!0)}function Ne(){qe();let e=en();Zt(.5)&&we(e),be(e);let t=zt(),n=j/-6*e;if(t<.65){let t=We();xe(j/-6*e,0,180,0,t),(h||Zt(.3125))&&(xe(j/-6*e,0,135,0,t),xe(j/-6*e,0,90,0,t),h&&xe(j/-6*e,0,70)),Zt(.1)&&Tt(n,0,245)}else t<.9?(at(n,0),(Zt(.1)||0===I)&&Tt(n,0,245)):t<.97?Tt(n,0,245):t<.99?qt(n,0,3):ut(j/-6*e,0,300);Zt(.5)&&He(-1*e,1),Zt(.5)&&He(-1*e,-1),de(e)}function we(e=-1){push(),T&&stroke(i),line(j*e/6-1,20-U/2,j*e/6-1,U/2-20),line(j*e/6+1,20-U/2,j*e/6+1,U/2-20),pop()}function be(e=-1,t=!1){if(Zt(.5)&&!t)Fe(U/3*(Zt(.5)?1:-1),e);else{let t=tn([1,2,3]);Fe(-U/3,e,1!=t),Fe(0,e,2!=t),Fe(U/3,e,3!=t)}}function Fe(e,t,n=!1){let o=j/3*t;G&&!e&&!t||Zt(.15)&&n?xe(o,e,55,0,We()):qt(o,e,1.1)}function He(e=1,t=1){push(),strokeCap(SQUARE);let n=j/2*e,o=-U/2*t;line(n-35*e,o+20*t,n-10*e,o+20*t),line(n-10*e,o+20*t,n-10*e,o+45*t),line(n-35*e,o+25*t,n-15*e,o+25*t),line(n-15*e,o+25*t,n-15*e,o+45*t),pop()}function ve(){ln(25,()=>{let e=zt(25,200);let t=zt(B,y),n=zt(q,Q);xe(t,n,e,Zt(.5)?0:zt(e/5,e),{skipBg:Zt(.9)}),Zt(.5)&&qt(t,n,e/120)})}function xe(e,t,n,o=0,r={}){h&&(n*=.75),p&&(r={...r,fillC:ROSETTE_FILL_C,strokeMod:6});let s=h?$e(r):Be(r);r.skipBg||(s.innerC?Ke(e,t,n,o,s):("NUMISMATIC"===a?Ge:h?Ue:Ke)(e,t,n,o,{...s,strokeC:ROSETTE_FILL_C,fillC:ROSETTE_FILL_C,strokeMod:6})),Ve()(e,t,n,r.holeR||o,{...s,strokeC:ROSETTE_STROKE_C,innerC:!1})};