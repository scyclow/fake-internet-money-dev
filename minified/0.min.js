let e,t,n,o,r,s,i,c,l,f,u,a,h,p,C,T,E,k,I,_,d,O,S,g,W,M,R,L,A,P,N,w,F,b,v,H,x,V;const D=700,G=400,X=D/G,j=4,K=-D/2,U=D/2,Y=-G/2,$=G/2,m={1:[K,Y],2:[U,Y],3:[K,$],4:[U,$]};let B,y,q=!1,Q=!1;function setup(){const t=window.innerWidth/window.innerHeight;X<t?(B=createCanvas(window.innerHeight*X,window.innerHeight),e=window.innerHeight/G):X>t?(B=createCanvas(window.innerWidth,window.innerWidth/X),e=window.innerWidth/D):(B=createCanvas(window.innerWidth,window.innerHeight),e=window.innerWidth/D),y=createGraphics(D*j,G*j),noLoop(),colorMode(HSB,360,100,100,100),z()}function z(){const e=Ut(0);e<.5?u="1":e<.75?u="5":e<7/8?u="10":e<.9375?u="20":e<31/32?u="50":e<63/64?u="100":e<127/128&&(u="2"),E=Yt(.2);const l=Ut(1);let D;if(COLOR_SCHEME=l<.75?"FIAT":l<.9375?"CRYPTO":"BULLION",C="BULLION"===COLOR_SCHEME,IS_CRYPTO="CRYPTO"===COLOR_SCHEME,"FIAT"===COLOR_SCHEME)f=int(Kt(0,360)),t=color(f,26,25),o=color(Bt(f-72),6,91),r=color(Bt(max(f-72,0)),6,91),n=color(f,16,55),c=color(Bt(f-145),80,64),LIGHT_ACCENT_C=color(Bt(f-145),55,64,30),s=color(max(f-10,0),80,54),i=s,R=Yt(.02);else if("CRYPTO"===COLOR_SCHEME){const e=(f=int(Kt(0,360)))<275&&f>210;o=color(Bt(f-133),96,e?0:15),t=color(f,e?80:99,e?95:90),n=color(f,69,75),c=color(Bt(f-254),100,100),LIGHT_ACCENT_C=c,i=s=c,r=o}else f=int(Kt(0,360)),t=color(f,26,25),l<.984375?(o=color(203,5,48),s=color(167,5,95),t=color(40,26,20),n=color(203,10,35),i=n,D=!0):(o=color(40,60,67),s=color(60,30,100),t=color(35,45,30),n=color(35,45,35),i=color(203,10,25)),c=t,LIGHT_ACCENT_C=n,r=o,T=!0;const G="MAIN"==(V=Ut(2)<.8125?"MAIN":Ut(2)<.95?"STRIP":"GRID");MAIN_CENTER_PIECE=re(Ut(3)),_=G&&Ut(4),d=G&&(_&&Yt(.95)||Yt(.8));const X=Ut(5);X<.0625?(a="DECO",p=!0):X<.625?a="NUMISMATIC":X<.8125?(a="VINTAGE",h=!0):a=X<.875?"ECHO":X<.9375?"DIGITAL":"LINE",L=Yt(.0625);const j=Yt(.5)||C,K=D?s:r,U=!T||p||h||C?t:i;ROSETTE_FILL_C=h||j?K:U,ROSETTE_STROKE_C=h||j?U:K,T=!h&&Yt(.125);const Y=Ut(6);!G||_||Y<.125?(k="STANDARD",I=Ye()):k=Y<.5?"WM2":Y<.8125?"WM1":h||p?Yt(.5)?"WM1":"WM2":Y<.9375||IS_CRYPTO?"FULL":"EMPTY",S=[0,1,3,5].includes(MAIN_CENTER_PIECE)&&"WM2"!==k&&Ut(7)<.125,g=Ut(7)<.03125,W=S&&Yt(.5),M=!d&&8!==I&&!W,serialSeed=Kt(),H=serialSeed<.005?0:serialSeed<.01?1:serialSeed<.015?2:serialSeed<.02?3:serialSeed<.025?4:serialSeed<.03?5:serialSeed<.035?6:"",O=Ut(8)<.02,A=Yt(.015),P=Yt(.01),N=Yt(.01),b=Yt(.01),w=Yt(.005),F=Yt(.005),x=!H&&!O&&Yt(.05),v=A||P||L}function J(){push();const e=$t(),n=Kt(0,100);C||strokeWeight(2);for(let r=-n;r<=D+n;r++){const i=1===e?r-D/2:D/2-r;stroke(lerpColor(o,R||C||T?s:t,R||C||IS_CRYPTO&&T?r/D:r/(5*D))),line(i+n,-G/2,i,G/2)}pop(),"FIAT"===COLOR_SCHEME&&me(),"CRYPTO"!==COLOR_SCHEME&&$e()}function draw(){translate(width/2,height/2),scale(e),noFill(),stroke(t),J(),N&&ee(),b&&Z(),"MAIN"===V?oe():"STRIP"===V?Me():We(),F&&te(),w&&ne(),console.log("$"+(u||0))}function keyPressed(){83===keyCode&&saveCanvas(B,"FIM-"+Date.now(),"jpg")}function Z(){translate(-1)}function ee(){translate(Kt(D/4,G/4)*$t(),Kt(D/4,G/4)*$t()),rotate(Kt(HALF_PI,-HALF_PI))}function te(){push(),fill(o),strokeWeight(0),beginShape(),vertex(Kt(-D/2,D/2),-G/2),vertex(Kt(-D/2,D/2),G/2),vertex(Kt(-D/2,D/2),-G/2),endShape(),pop()}function ne(){for(let e=0;e<=D;e++)for(let t=0;t<=G;t++)strokeWeight(0),fill(0,0,100,Kt(0,70)),rect(e-D/2,t-G/2,2)}function oe(){const e=d||v?se():[];let t=[],o=!1;if("STANDARD"===k)Ue();else if("WM2"===k)nt(t=pe(e));else if("WM1"===k){const o=he(e);t=[o];const r=175*fe(o),s=80*ue(o,4===e.length),i=T?LIGHT_ACCENT_C:n;Yt(.8)?ut(r,s,i):Ct(r+15,s,245,i)}else"FULL"===k&&(ot(),o=!0);switch(_&&dt(),ie(e),MAIN_CENTER_PIECE){case 0:break;case 1:de();break;case 2:Oe();break;case 3:Ee();break;case 4:Se()}const r=$t();S&&(W?Ie(r):ke(r)),g&&(Yt(.5)?ke(-1*r):Ie(-1*r)),Ce(t.length||4===e.length?t:e,o)}function re(e){if("MAIN"===V)return e<.6875?1:e<.8125?2:e<.9375?3:4}function se(){const e=Kt();return e<.25?[1,2,3,4]:e<.5?[1,4]:e<.75?[2,3]:e<.825?[1,2]:e<.9375?[3,4]:[int(Kt(1,5))]}function ie(e=[]){const t=Yt(.125),n=4===e.length&&Yt(.5)?[mt([1,3]),mt([2,4])]:[],o=Ge(_e());e.forEach(e=>{const[r,s]=m[e],i=r+(e%2==1?57:-57),c=s+(e<3?57:-57),l=t||n.includes(e)?41.25:0;Ne(i,c,55,0,{...o,holeR:l}),Gt(i,c,.35,ROSETTE_FILL_C,ROSETTE_STROKE_C)})}const ce=e=>[1,2,3,4].filter(t=>!e.includes(t)),le=e=>({1:4,2:3,3:2,4:1})[e],fe=e=>e%2!=0?-1:1,ue=(e,t)=>t?0:e<3?-1:1,ae=(e,t)=>e.every((e,n)=>e===t[n])&&e.length===t.length,he=e=>4!==e.length&&e.length?1===e.length?le(e[0]):mt(ce(e)):mt([1,2,3,4]);function pe(e){return 4!==e.length&&e.length?ae(e,[1,4])||ae(e,[2,3])?mt([[1,4],[2,3]]):1===e.length?ce([e[0],le(e[0])]):[le(e[0]),le(e[1])]:mt([[1,4],[2,3],[1,2],[3,4]])}function Ce(e=[],t=!1){const n=115+(_?0:30),o=1===e.length?le(e[0]):mt(ce(e)),r=mt(ce([o,...e])),s=(_?150:120)*fe(o),i=150*fe(r);rt(s>0?s+85:s,n*ue(o),10,t),lt(i<0?i-65:i,n*ue(r))}function Te(e,t=!1){if(push(),t||Yt(.25))rotate(.75*TWO_PI*e),lt(-D/6-25,-D/3-80),rt(D/6+35,-D/3-80,10);else{const t=e>0;lt((5*D/12+(t?30:-35))*-e,G/3+15),rt(t?70:-5,G/3+20,10)}pop()}function Ee(){const e=h?{c1:-1,c2:185}:{holeR:135,c1:1,c2:-1,r1:15,r2:14,..._e()};Ne(0,0,h?170:155,0,e);const t=Kt();M||t<.1?Xt(0,0,2.3):t<.8?ut(0,0,ROSETTE_STROKE_C,h?.5:.7):t<.92?Ct(0,0,200):t<.98&&ft(0,0,250)}function ke(e){const t=int(Kt(3,11))*$t();He(210*e,20,40,0,je({strokeC:c,strokeW:1,rDiff:2,ignoreShrink:!0,c1:t,c2:(t+5)*$t()}))}function Ie(e){Gt(205*e,20,.65,LIGHT_ACCENT_C,LIGHT_ACCENT_C)}const _e=()=>h?{}:{strokeC:ROSETTE_STROKE_C,innerC:T?ROSETTE_STROKE_C:n,outterC:ROSETTE_FILL_C};function de(){const e=!h&&Yt(.5),t=Yt(.25)?mt([1,2]):0,n=_e();Ne(0,0,150,0,n),e?Ne(0,0,70,0,{...n,holeR:60}):t&&(Ne(0,0,110,0,0,n),t>1&&Ne(0,0,70,0,0,n)),(M||e||t<2||Yt(.9375))&&Xt(0,0,1)}function Oe(){const e=mt([1,2,3]),t=_e();if(3===e){const e=Ge(t);Ne(150,0,80,0,e),Ne(-150,0,80,0,e)}const n=Ge(t);if(Ne(110,0,100,0,n),Ne(-110,0,100,0,n),e>1){const e=Ge(t);Ne(60,0,130,0,e),Ne(-60,0,130,0,e)}Ne(0,0,150,0,Ge(t)),Ne(0,0,70,0,{...Ge(t),holeR:u?60:0}),Xt(0,0,.65)}function Se(){const e=Kt(),t=_e();if(e<.125){const e=Ge(t);Ne(25,-120,25,0,e),Ne(25,120,25,0,e),Ne(-25,-120,25,0,e),Ne(-25,120,25,0,e)}if(e<.25){const e=Ge(t);Ne(50,-90,45,0,e),Ne(50,90,45,0,e),Ne(-50,-90,45,0,e),Ne(-50,90,45,0,e)}if(e<.5){const e=Ge(t);Ne(90,-50,70,0,e),Ne(90,50,70,0,e),Ne(-90,-50,70,0,e),Ne(-90,50,70,0,e)}const n=Ge(t);Ne(130,0,90,0,n),Ne(-130,0,90,0,n),Xt(0,0,.65)}function ge(){const e=_e();Ne(0,0,120,0,Ge(e)),Ne(0,0,90,0,Ge(e)),Ne(0,0,60,0,Ge(e)),Vt(u,-142,2,.65,t),Vt(u,142,2,.65,t),Vt(u,-140,0,.65,t,o),Vt(u,140,0,.65,t,o)}function We(){Ue(),Le(1,!0),Le(0,!0),Le(-1,!0),Te($t(),!0)}function Me(){Ue();const e=$t();Yt(.5)&&Re(e),Le(e);const t=Kt(),n=D/-6*e;if(t<.65){const t=_e();Ne(D/-6*e,0,180,0,t),(h||Yt(.3125))&&(Ne(D/-6*e,0,135,0,t),Ne(D/-6*e,0,90,0,t),h&&Ne(D/-6*e,0,70)),Yt(.1)&&Ct(n,0,245)}else t<.9?(ut(n,0),(Yt(.1)||0===I)&&Ct(n,0,245)):t<.97?Ct(n,0,245):t<.99?Xt(n,0,3):ft(D/-6*e,0,300);Yt(.5)&&Pe(-1*e,1),Yt(.5)&&Pe(-1*e,-1),Te(e)}function Re(e=-1){push(),T&&stroke(i),line(D*e/6-1,20-G/2,D*e/6-1,G/2-20),line(D*e/6+1,20-G/2,D*e/6+1,G/2-20),pop()}function Le(e=-1,t=!1){if(Yt(.5)&&!t)Ae(G/3*(Yt(.5)?1:-1),e);else{const t=mt([1,2,3]);Ae(-G/3,e,1!=t),Ae(0,e,2!=t),Ae(G/3,e,3!=t)}}function Ae(e,t,n=!1){const o=D/3*t;v&&!e&&!t||Yt(.15)&&n?Ne(o,e,55,0,_e()):Xt(o,e,1.1)}function Pe(e=1,t=1){push(),strokeCap(SQUARE);const n=D/2*e,o=-G/2*t;line(n-35*e,o+20*t,n-10*e,o+20*t),line(n-10*e,o+20*t,n-10*e,o+45*t),line(n-35*e,o+25*t,n-15*e,o+25*t),line(n-15*e,o+25*t,n-15*e,o+45*t),pop()}function Ne(e,t,n,o=0,r={}){h&&(n*=.75),p&&(r={...r,fillC:ROSETTE_FILL_C,strokeMod:6});const s=h?Xe(r):je(r);s.innerC?ve(e,t,n,o,s):("NUMISMATIC"===a?be:h?De:ve)(e,t,n,o,{...s,strokeC:ROSETTE_FILL_C,fillC:ROSETTE_FILL_C,strokeMod:6}),we()(e,t,n,r.holeR||o,{...s,strokeC:ROSETTE_STROKE_C,innerC:!1})}const we=()=>P?mt([be,He,Ve,xe,De]):["NUMISMATIC","DECO"].includes(a)?be:"ECHO"===a?He:"DIGITAL"===a?Ve:"LINE"===a?xe:h?De:yt;function Fe(){Ne(0,0,90,0,je({fillC:ROSETTE_FILL_C,strokeMod:6}))}function be(e,t,n=200,o=100,r={},s=window){s.push(),r.strokeC&&s.stroke(r.strokeC),r.fillC&&s.fill(r.fillC);const i=r.strokeMod||1,c=r.points,l=Ke(e,t,c,r.c1,r.c2,r.r1,r.r2);for(let e=0;e<6;e++)s.strokeWeight(((r.strokeW||.7)+n/150-1)*i),zt(c,t=>{const[o,r]=l(n,t,e/3),[s,i]=l(.95*n,t,e/3);return t%2==0?[s,i]:[o,r]},s);let f=n,u=.75*n,a=0;for(;u>=o&&a<20;){s.strokeWeight((r.strokeW||1)+f/150-1);for(let e=0;e<6;e++)zt(c,t=>{const[n,o]=l(f,t,e/3),[r,s]=l(u,t,e/3);return t%2==0?[r,s]:[n,o]},s);(f=1.045*u)<10?u=0:u-.75*u<10?u=f-10:u*=.75,a++}s.pop()}function ve(...e){He(...e,!0)}function He(e=0,t=0,n=200,o=100,r={},s=!1){push(),r.strokeC&&stroke(r.strokeC),s&&strokeWeight(2),r.strokeW&&strokeWeight(r.strokeW);const i=Ke(e,t,r.points,r.c1,r.c2,r.r1,r.r2),c=r.rDiff||(s?1:5),l=s?int(n/40):0;for(let e=o;e<=n+l;e+=c)!s&&!r.ignoreShrink&&strokeWeight(e*r.strokeW/130),r.innerC&&r.outterC&&stroke(lerpColor(r.innerC,r.outterC,(e-o)/(n-o))),qt(r.points,t=>i(e,t));pop()}function xe(e=0,t=0,n=200,o=100,r={}){push(),r.strokeC&&stroke(r.strokeC),r.strokeW&&strokeWeight(r.strokeW);const s=r.points/2,i=Ke(e,t,s,r.c1,r.c2,r.r1,r.r2);for(let e=0;e<s;e+=.2){const[t,r]=i(n,e),[s,c]=i(o,e);line(s,c,t,r)}pop()}function Ve(e=0,t=0,n=200,o=100,r={}){xe(e,t,n,o,r),He(e,t,n,o,r)}function De(e=0,t=0,n=90,o=0,r={}){push(),r.strokeC&&stroke(r.strokeC),r.fillC&&fill(r.fillC),r.strokeW&&strokeWeight(r.strokeW);const s=n/r.r1,i=n/r.r2,c=r.points,l=c/r.c1,f=c/r.c2;zt(c,o=>{const r=o/c*TWO_PI,u=o/l*TWO_PI,a=o/f*TWO_PI,h=Qt(r,n,e,t),[p,C]=Qt(u,s,h[0],h[1]);return Qt(a,i,p,C)}),pop()}const Ge=e=>h?Xe(e):je(e),Xe=e=>({c1:int(Kt(1,13))*$t(),c2:int(Kt(170,192))*$t(),r1:9,r2:5,strokeC:ROSETTE_STROKE_C,points:360,...e}),je=e=>({c1:int(Kt(1,L?25:16))*$t(),c2:int(Kt(1,L?20:13))*$t(),r1:L?Kt(4,10):Kt(10,20),r2:L?Kt(4,10):Kt(10,20),points:70,...e}),Ke=(e,t,n,o,r,s,i)=>{const c=n/o,l=n/r;return(o,r,f=0,u=null,a=null)=>{const h=(r+f)/n,p=(r+f)/c,C=(r+f)/l,T=u||1/s,E=a||1/i,k=1-T-E,[I,_]=Qt(h*TWO_PI,o*k,e,t),[d,O]=Qt(p*TWO_PI,o*T,I,_);return Qt(C*TWO_PI,o*E,d,O)}};function Ue(){switch(I){case 0:tt();break;case 1:et();break;case 2:ye();break;case 3:qe();break;case 4:Qe();break;case 5:ze();break;case 6:Je();break;case 7:Ze();break;case 8:Be()}}function Ye(){const e=Kt();return Yt(IS_CRYPTO?.125:.01)?0:e<.125?1:e<.25?2:e<.375?3:e<.5?4:e<.625?5:e<.75?6:e<.875?7:8}function $e(){push(),noFill(),strokeWeight(Kt(.1,.5));for(let e=0;e<40;e++){stroke(C?s:Yt(.75)?t:c);const e=Kt(-D/2,D/2),n=Kt(-G/2,G/2),o=e+Kt(-25,25),r=o+Kt(-25,25),i=r+Kt(-25,25),l=n+Kt(-25,25),f=l+Kt(-25,25),u=f+Kt(-25,25);beginShape(),curveVertex(e+Kt(-20,20),n+Kt(-20,20)),curveVertex(e,n),curveVertex(o,l),curveVertex(r,f),curveVertex(i,u),endShape()}pop()}function me(){push();for(let e=-D/2;e<D/2;e+=5)for(let t=-G/2;t<G/2;t+=5)strokeWeight(Kt(1,2)),stroke(color(f,26,25,Kt(0,40))),point(e+Kt(-5,5),t+Kt(-5,5));pop()}function Be(){push(),strokeWeight(1);for(let e=-D/2;e<D/2;e+=20)for(let n=-G/2;n<G/2;n+=20){const o=Kt(.01,.15),r=Yt(.3),s=r?0:Kt(-10,10),i=r?0:Kt(-10,10);xt(bt(),e+s+10,n+i+10,o,t)}pop()}function ye(){push(),stroke(t),strokeWeight(.5);for(let e=-D/2;e<D/2;e+=10)for(let t=-G/2;t<G/2;t+=10)Yt(.5)?line(e,t,e+10,t+10):line(e+10,t,e,t+10);pop()}function qe(){push(),noFill(),strokeWeight(.5);const e=T||Yt(.5);for(let t=0,n=0;t<=G+5;t+=15,n++){const o=t-G/2;beginShape(),curveVertex(-30-D/2,o-7.5);for(let t=0;t<D/30+2;t++){const r=n%2==0?t%2==0?7.5:-7.5:t%2==0?-7.5:7.5;curveVertex(30*t-D/2,o+r),e&&(fill(s),circle(30*t-D/2,o+r,4),noFill())}endShape()}pop()}function Qe(){push(),noFill(),strokeWeight(.5);for(let e=0;e<D;e+=100)for(let t=0;t<G;t+=100)if(t/100%2==0&&e/100%2==0||t/100%2==1&&e/100%2==1)for(let n=0;n<100;n+=4)line(e-D/2,n+t+2-G/2,e+100-D/2,n+t+2-G/2);else for(let n=0;n<100;n+=4)line(n+e+2-D/2,t-G/2,n+e+2-D/2,t+100-G/2);pop()}function ze(){push(),noFill(),strokeWeight(.5);for(let e=-5;e<G+8;e+=G/100){const t=e-G/2;beginShape(),curveVertex(-30-D/2,t-7.5);for(let e=0;e<D/30+2;e++)curveVertex(30*e-D/2,t+(e%2==0?7.5:-7.5));endShape()}pop()}function Je(){push(),strokeWeight(.35),T&&fill(LIGHT_ACCENT_C),stroke(n);for(let e=0;e<D;e+=10)for(let t=0;t<G;t+=10){const n=e-D/2,o=t-G/2;if(Yt(.5)){line(n,o,n+10,o+10);const e=Kt();e<.15?circle(n,o,4):e<.3&&circle(n+10,o+10,4)}else{line(n+20,o,n,o+20);const e=Kt();e<.15?circle(n+20,o,4):e<.3&&circle(n,o+20,4)}}pop()}function Ze(){push(),strokeWeight(1),stroke(n);for(let e=-D/2-G/2;e<G/2+D/2;e+=5)line(e,-G/2,G/2+e,0),line(G/2+e,0,e,G/2);pop()}function et(){push(),strokeWeight(.35),stroke(n);for(let e=-D/2;e<D/2+1;e+=10)for(let t=-G/2;t<G/2+1;t+=10)circle(e,t,14);pop()}function tt(){push();const e=int(Kt(2,5));for(let n=0;n<D;n+=e)for(let r=0;r<G;r+=e)fill(lerpColor(o,t,Kt(.75))),noStroke(),rect(D/2-n-e,G/2-r-e,e,e);pop()}function nt(e=[2,4]){push();const n=h?be:we(),o=je({strokeC:t,strokeW:.35}),r=Kt(0,D/4);e.forEach(e=>n(m[e][0],m[e][1],D/2,r,o)),pop()}function ot(){Ne(0,0,D,0)}function rt(e,n,r,s){if(x)return;push(),noFill(),strokeWeight(1.5);let i=e-8*r,l=n+r/2;const f=[[i-Kt(r),l-Kt(r)],[i,l]];Jt(8,()=>{const e=Yt(.75),t=i+r*(1+.1*(e?-7:7))/2,n=l+(e?Yt(.85)?r*Kt(0,.3):r*Kt(1,1.5):-1*(Yt(.5)?r*Kt(0,.3):r*Kt(1,1.5))),o=i+r*Kt(.9,1.1),s=l+r*Kt(-.1,.1);f.push([t,n]),f.push([o,s]),i=o,l=s}),f.push([i+Kt(r),l+Kt(r)]),s?stroke(t):stroke(o),beginShape(),f.forEach(([e,t])=>curveVertex(e+1,t+1)),endShape(),s?stroke(c):stroke(t),beginShape(),f.forEach(([e,t])=>curveVertex(e,t)),endShape(),pop()}